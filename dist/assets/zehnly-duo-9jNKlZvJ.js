import{r as j,f as M,j as e,B as N,t as S,o as ye,s as K,n as De,_ as os}from"./index-CsXLUnfy.js";import{u as P,T as Ue,a as Oe,b as J,c as T,d as We,e as k,E as Ie,S as ie,f as Me,F as we,g as D,h as F,i as A,j as E,k as q,l as Z,m as Es,M as qs}from"./table-CU5QHOeX.js";import{C as V,b as z,c as G,d as R,e as Q,u as ve,a as be,I as $}from"./card-CIvVsfPA.js";import{T as Ce,a as Ts,b as ks,c as Se,d as Le}from"./textarea-Ch7azh-_.js";import{H as Us,S as Os,T as Ws,C as Is,P as Ms}from"./config-drawer-BOCjIL-U.js";import{c as b,C as ss,b as ae,F as Fe}from"./content-api-C9J9D9tx.js";import{U as Ps,C as Bs,E as Ks}from"./upload-course-logo-dialog-BsNQZPSt.js";import{M as X,A as Vs,s as zs,t as Gs,D as Pe,j as Be,k as Ke,l as Ve,n as Y,N as ze,O as oe,Q as Ge,R as de,T as ce,U as xe,V as he,W as me,X as ts,Y as Te,Z as le,_ as Rs,$ as Qs}from"./sign-out-dialog-G8YN-xzd.js";import{g as $s}from"./media-utils-Cpm_6zhn.js";import{U as B}from"./upload-Cs3gv4Jh.js";import{C as Hs,a as Zs,E as Xs}from"./chapters-table-BpdUW2Mw.js";import{B as pe}from"./badge-ZZTIeOX4.js";import{S as ee,a as se,b as te,c as ne,d as U}from"./select-BSuPs2ZA.js";import{V as fe}from"./volume-2-xgxXlBfw.js";import{I as ke}from"./image-byhLTcM2.js";import{c as ds}from"./createLucideIcon-CYEOcWL4.js";import{P as _e}from"./plus-BwYmgaLr.js";import"./loader-circle-XPVMKrjQ.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]],Js=ds("file-audio",Ys);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]],st=ds("file-image",et);function tt({data:s,isLoading:y,onEdit:p,onCourseClick:w,onRefresh:g,selectedCourse:o}){const[n,l]=j.useState(!1),[d,c]=j.useState(!1),[x,f]=j.useState(null),[v,i]=j.useState(null),a=M(),h=P({mutationFn:u=>b.courses.delete(u),onSuccess:u=>{S.success(u.message),a.invalidateQueries({queryKey:["courses"]}),g(),l(!1),f(null)},onError:u=>{S.error("Failed to delete course"),console.error("Delete error:",u)}}),t=(u,L)=>{L.stopPropagation(),f(u),l(!0)},m=(u,L)=>{L.stopPropagation(),p(u)},O=(u,L)=>{L.stopPropagation(),i(u),c(!0)},H=()=>{x&&h.mutate(x.id)},C=()=>{a.invalidateQueries({queryKey:["courses"]}),g(),c(!1),i(null)};return y?e.jsxs(V,{children:[e.jsxs(z,{children:[e.jsx(G,{children:"Courses"}),e.jsx(R,{children:"Loading..."})]}),e.jsx(Q,{children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):s.length===0?e.jsxs(V,{children:[e.jsxs(z,{children:[e.jsx(G,{children:"Courses"}),e.jsx(R,{children:"No courses found"})]}),e.jsx(Q,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(X,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsxs("p",{className:"text-muted-foreground text-center",children:["No courses have been created yet.",e.jsx("br",{}),'Click "Add Course" to get started.']})]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(V,{className:"border-0 shadow-lg bg-gradient-to-br from-card via-card to-card/95",children:[e.jsx(z,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(G,{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5 text-primary"}),"Courses (",s.length,")"]}),e.jsx(R,{className:"mt-1",children:"Click on a course to view its chapters"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Courses"}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:s.length})]})]})}),e.jsx(Q,{children:e.jsxs(Ue,{children:[e.jsx(Oe,{children:e.jsxs(J,{children:[e.jsx(T,{children:"Course"}),e.jsx(T,{children:"Languages"}),e.jsx(T,{children:"Logo"}),e.jsx(T,{className:"w-[70px]",children:"Actions"})]})}),e.jsx(We,{children:s.map(u=>e.jsxs(J,{className:`cursor-pointer transition-colors hover:bg-muted/50 ${o?.id===u.id?"bg-muted":""}`,onClick:()=>w(u),children:[e.jsx(k,{className:"max-w-[350px]",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium truncate",title:u.title,children:u.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["ID: #",u.id]})]})}),e.jsx(k,{className:"max-w-[200px]",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"font-medium text-blue-600",children:u.native_language}),e.jsx("span",{className:"text-muted-foreground",children:"→"}),e.jsx("span",{className:"font-medium text-green-600",children:u.learning_language})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Native → Target"})]})}),e.jsx(k,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[u.logo_url?e.jsxs("div",{className:"relative",children:[e.jsxs(Vs,{className:"h-10 w-10 border-2 border-green-200",children:[e.jsx(zs,{src:$s(u.logo_url),alt:u.title}),e.jsx(Gs,{className:"bg-green-50",children:e.jsx(X,{className:"h-5 w-5 text-green-600"})})]}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-white"})]}):e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-100 border-2 border-gray-200 flex items-center justify-center",children:e.jsx(X,{className:"h-5 w-5 text-gray-400"})}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-gray-300 rounded-full border-2 border-white"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`text-xs font-medium ${u.logo_url?"text-green-600":"text-gray-500"}`,children:u.logo_url?"✓ Logo uploaded":"○ No logo"}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:u.logo_url?"Ready to display":"Upload recommended"})]})]})}),e.jsx(k,{children:e.jsxs(Pe,{children:[e.jsx(Be,{asChild:!0,children:e.jsxs(N,{variant:"ghost",className:"h-8 w-8 p-0",onClick:L=>L.stopPropagation(),children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(Ie,{className:"h-4 w-4"})]})}),e.jsxs(Ke,{align:"end",children:[e.jsx(Ve,{children:"Actions"}),e.jsxs(Y,{onClick:L=>O(u,L),children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Upload Logo"]}),e.jsxs(Y,{onClick:L=>m(u,L),children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(Y,{onClick:L=>t(u,L),className:"text-red-600",children:[e.jsx(Me,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},u.id))})]})})]}),e.jsx(ze,{open:n,onOpenChange:l,title:"Delete Course",desc:`Are you sure you want to delete "${x?.title}"? This action cannot be undone and will also delete all associated lessons and words.`,confirmText:"Delete",handleConfirm:H,isLoading:h.isPending}),v&&e.jsx(Ps,{open:d,onOpenChange:c,course:v,onSuccess:C})]})}function nt({data:s,isLoading:y,onEdit:p,onLessonClick:w,onRefresh:g,selectedLesson:o}){const[n,l]=j.useState(!1),[d,c]=j.useState(null),x=M(),f=P({mutationFn:t=>b.lessons.delete(t),onSuccess:t=>{S.success(t.message),x.invalidateQueries({queryKey:["lessons"]}),g(),l(!1),c(null)},onError:t=>{S.error("Failed to delete lesson"),console.error("Delete error:",t)}}),v=t=>{c(t),l(!0)},i=()=>{d&&f.mutate(d.id)},a=t=>{switch(t){case"word":return"bg-blue-100 text-blue-800 hover:bg-blue-100";case"story":return"bg-purple-100 text-purple-800 hover:bg-purple-100";case"test":return"bg-orange-100 text-orange-800 hover:bg-orange-100";default:return"bg-gray-100 text-gray-800 hover:bg-gray-100"}};if(y)return e.jsxs(V,{children:[e.jsxs(z,{children:[e.jsx(G,{children:"Lessons"}),e.jsx(R,{children:"Loading..."})]}),e.jsx(Q,{children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]});if(s.length===0)return e.jsxs(V,{children:[e.jsxs(z,{children:[e.jsx(G,{children:"Lessons"}),e.jsx(R,{children:"No lessons found"})]}),e.jsx(Q,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(X,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsxs("p",{className:"text-muted-foreground text-center",children:["No lessons have been created yet.",e.jsx("br",{}),'Click "Add Lesson" to get started.']})]})})]});const h=[...s].sort((t,m)=>t.order-m.order);return e.jsxs(e.Fragment,{children:[e.jsxs(V,{className:"border-0 shadow-lg bg-gradient-to-br from-card via-card to-card/95",children:[e.jsx(z,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(G,{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5 text-primary"}),"Lessons (",h.length,")"]}),e.jsx(R,{className:"mt-1",children:"Manage chapter lessons and their content"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Lessons"}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:h.length})]})]})}),e.jsx(Q,{children:e.jsxs(Ue,{children:[e.jsx(Oe,{children:e.jsxs(J,{children:[e.jsx(T,{children:"Order"}),e.jsx(T,{children:"Lesson Title"}),e.jsx(T,{children:"Type"}),e.jsx(T,{children:"Content"}),e.jsx(T,{className:"w-[70px]",children:"Actions"})]})}),e.jsx(We,{children:h.map(t=>{const m=o?.id===t.id,O=t.lesson_type==="test";return e.jsxs(J,{className:`transition-colors ${O?"cursor-not-allowed opacity-70":"cursor-pointer hover:bg-muted/50"} ${m?"bg-muted border-l-4 border-l-primary":""}`,onClick:()=>!O&&w?.(t),children:[e.jsx(k,{children:e.jsx(pe,{variant:"outline",className:"w-8 h-8 rounded-full flex items-center justify-center p-0",children:t.order})}),e.jsx(k,{className:"max-w-[300px]",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium truncate",title:t.title,children:t.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["ID: #",t.id]})]})}),e.jsx(k,{children:e.jsx(pe,{variant:"secondary",className:a(t.lesson_type),children:t.lesson_type.charAt(0).toUpperCase()+t.lesson_type.slice(1)})}),e.jsx(k,{className:"max-w-[400px]",children:e.jsx("p",{className:"text-sm text-muted-foreground truncate",title:t.content,children:t.content})}),e.jsx(k,{children:e.jsxs(Pe,{children:[e.jsx(Be,{asChild:!0,children:e.jsxs(N,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(Ie,{className:"h-4 w-4"})]})}),e.jsxs(Ke,{align:"end",children:[e.jsx(Ve,{children:"Actions"}),e.jsxs(Y,{onClick:()=>p(t),children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(Y,{onClick:()=>v(t),className:"text-red-600",children:[e.jsx(Me,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},t.id)})})]})})]}),e.jsx(ze,{open:n,onOpenChange:l,title:"Delete Lesson",desc:`Are you sure you want to delete "${d?.title}"? This action cannot be undone.`,confirmText:"Delete",handleConfirm:i,isLoading:f.isPending})]})}const rt=ye({title:K().min(1,"Lesson title is required"),lesson_type:os(["word","story"]),order:De().min(1,"Order must be at least 1"),content:K().min(1,"Content is required")});function at({chapterId:s,children:y,onSuccess:p}){const[w,g]=j.useState(!1),o=M(),n=ve({resolver:be(rt),defaultValues:{title:"",lesson_type:"word",order:1,content:""}}),l=P({mutationFn:c=>b.lessons.create({...c,chapter_id:s}),onSuccess:()=>{S.success("Lesson created successfully"),o.invalidateQueries({queryKey:["lessons",s]}),n.reset(),g(!1),p?.()},onError:c=>{S.error("Failed to create lesson"),console.error("Create lesson error:",c)}}),d=c=>{l.mutate(c)};return e.jsxs(oe,{open:w,onOpenChange:g,children:[e.jsx(Ge,{asChild:!0,children:y||e.jsxs(N,{children:[e.jsx(ss,{className:"h-4 w-4"}),"Add Lesson"]})}),e.jsxs(de,{className:"sm:max-w-[600px]",children:[e.jsxs(ce,{children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5"}),"Create New Lesson"]}),e.jsx(he,{children:"Add a new lesson to this chapter with content and exercises."})]}),e.jsx(we,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(d),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsx(D,{control:n.control,name:"title",render:({field:c})=>e.jsxs(F,{children:[e.jsx(A,{children:"Lesson Title *"}),e.jsx(E,{children:e.jsx($,{placeholder:"e.g., Hello and Goodbye",...c})}),e.jsx(q,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(D,{control:n.control,name:"lesson_type",render:({field:c})=>e.jsxs(F,{children:[e.jsx(A,{children:"Lesson Type *"}),e.jsxs(ee,{onValueChange:c.onChange,defaultValue:c.value,children:[e.jsx(E,{children:e.jsx(se,{children:e.jsx(te,{placeholder:"Select lesson type"})})}),e.jsxs(ne,{children:[e.jsx(U,{value:"word",children:"Word"}),e.jsx(U,{value:"story",children:"Story"}),e.jsx(U,{value:"test",children:"Test"})]})]}),e.jsx(q,{})]})}),e.jsx(D,{control:n.control,name:"order",render:({field:c})=>e.jsxs(F,{children:[e.jsx(A,{children:"Order *"}),e.jsx(E,{children:e.jsx($,{type:"number",min:"1",placeholder:"1",...c,onChange:x=>c.onChange(parseInt(x.target.value)||1)})}),e.jsx(q,{})]})})]}),e.jsx(D,{control:n.control,name:"content",render:({field:c})=>e.jsxs(F,{children:[e.jsx(A,{children:"Content *"}),e.jsx(E,{children:e.jsx(Ce,{placeholder:"In this lesson we learn basic greetings...",className:"min-h-[120px]",...c})}),e.jsx(q,{})]})})]}),e.jsxs(me,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(N,{type:"submit",disabled:l.isPending,className:"min-w-[120px]",children:l.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creating..."]}):"Create Lesson"})]})]})})]})]})}const lt=ye({title:K().min(1,"Lesson title is required"),lesson_type:os(["word","story","test"]),order:De().min(1,"Order must be at least 1"),content:K().min(1,"Content is required"),word_lesson_id:De().optional()});function it({lesson:s,open:y,onOpenChange:p,onSuccess:w}){const g=M(),[o,n]=j.useState(""),l=ve({resolver:be(lt),defaultValues:{title:"",lesson_type:"word",order:1,content:"",word_lesson_id:void 0}}),d=l.watch("lesson_type"),{data:c,isLoading:x}=Z({queryKey:["word-lessons",s?.chapter_id],queryFn:async()=>s?.chapter_id?(await b.lessons.listByChapter(s.chapter_id)).filter(h=>h.lesson_type==="word"&&h.id!==s?.id):[],enabled:d==="test"&&!!s&&y}),f=c?.filter(a=>a.title.toLowerCase().includes(o.toLowerCase()))||[],v=P({mutationFn:a=>{if(!s)throw new Error("No lesson selected");return b.lessons.update(s.id,a)},onSuccess:()=>{S.success("Lesson updated successfully"),g.invalidateQueries({queryKey:["lessons",s?.chapter_id]}),p(!1),w?.()},onError:a=>{S.error("Failed to update lesson"),console.error("Update lesson error:",a)}});j.useEffect(()=>{s&&l.reset({title:s.title,lesson_type:s.lesson_type,order:s.order,content:s.content,word_lesson_id:s.word_lesson_id})},[s,l]);const i=a=>{v.mutate(a)};return s?e.jsx(oe,{open:y,onOpenChange:p,children:e.jsxs(de,{className:"sm:max-w-[600px]",children:[e.jsxs(ce,{children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"Edit Lesson"]}),e.jsx(he,{children:"Update the lesson information, type, and content."})]}),e.jsx(we,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(i),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsx(D,{control:l.control,name:"title",render:({field:a})=>e.jsxs(F,{children:[e.jsx(A,{children:"Lesson Title *"}),e.jsx(E,{children:e.jsx($,{placeholder:"e.g., Hello and Goodbye",...a})}),e.jsx(q,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(D,{control:l.control,name:"lesson_type",render:({field:a})=>e.jsxs(F,{children:[e.jsx(A,{children:"Lesson Type *"}),e.jsxs(ee,{onValueChange:a.onChange,value:a.value,children:[e.jsx(E,{children:e.jsx(se,{children:e.jsx(te,{placeholder:"Select lesson type"})})}),e.jsxs(ne,{children:[e.jsx(U,{value:"word",children:"Word"}),e.jsx(U,{value:"story",children:"Story"}),e.jsx(U,{value:"test",children:"Test"})]})]}),e.jsx(q,{})]})}),e.jsx(D,{control:l.control,name:"order",render:({field:a})=>e.jsxs(F,{children:[e.jsx(A,{children:"Order *"}),e.jsx(E,{children:e.jsx($,{type:"number",min:"1",placeholder:"1",...a,onChange:h=>a.onChange(parseInt(h.target.value)||1)})}),e.jsx(q,{})]})})]}),d==="test"&&e.jsx(D,{control:l.control,name:"word_lesson_id",render:({field:a})=>e.jsxs(F,{children:[e.jsx(A,{children:"Connect to Word Lesson *"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ts,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx($,{placeholder:"Search word lessons...",value:o,onChange:h=>n(h.target.value),className:"pl-10"})]}),e.jsxs(ee,{onValueChange:h=>a.onChange(parseInt(h)),value:a.value?.toString(),disabled:x,children:[e.jsx(E,{children:e.jsx(se,{children:e.jsx(te,{placeholder:"Select a word lesson to connect"})})}),e.jsxs(ne,{className:"max-h-60",children:[f.map(h=>e.jsx(U,{value:h.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:h.title}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Order: ",h.order]})]})]})},h.id)),f.length===0&&!x&&e.jsx("div",{className:"p-2 text-sm text-muted-foreground text-center",children:o?"No word lessons found matching your search":"No word lessons available"})]})]})]}),e.jsx(q,{})]})}),e.jsx(D,{control:l.control,name:"content",render:({field:a})=>e.jsxs(F,{children:[e.jsx(A,{children:"Content *"}),e.jsx(E,{children:e.jsx(Ce,{placeholder:"In this lesson we learn basic greetings...",className:"min-h-[120px]",...a})}),e.jsx(q,{})]})})]}),e.jsxs(me,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(N,{type:"submit",disabled:v.isPending,className:"min-w-[120px]",children:v.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Updating..."]}):"Update Lesson"})]})]})})]})}):null}function ot({data:s,isLoading:y,onEdit:p,onRefresh:w}){const[g,o]=j.useState(!1),[n,l]=j.useState(null),d=M(),c=P({mutationFn:i=>b.words.delete(i),onSuccess:i=>{S.success(i.message),d.invalidateQueries({queryKey:["words"]}),w(),o(!1),l(null)},onError:i=>{S.error("Failed to delete word"),console.error("Delete error:",i)}}),x=i=>{l(i),o(!0)},f=()=>{n&&c.mutate(n.id)},v=i=>{if(i){const a=ae(i);a&&new Audio(a).play().catch(t=>{console.error("Error playing audio:",t),S.error("Failed to play audio")})}};return y?e.jsxs(V,{children:[e.jsxs(z,{children:[e.jsx(G,{children:"Words"}),e.jsx(R,{children:"Loading..."})]}),e.jsx(Q,{children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):s.length===0?e.jsxs(V,{children:[e.jsxs(z,{children:[e.jsx(G,{children:"Words"}),e.jsx(R,{children:"No words found"})]}),e.jsx(Q,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(Te,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsxs("p",{className:"text-muted-foreground text-center",children:["No words have been created yet.",e.jsx("br",{}),'Click "Add Word" to get started.']})]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(V,{className:"border-0 shadow-lg bg-gradient-to-br from-card via-card to-card/95",children:[e.jsx(z,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(G,{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5 text-primary"}),"Words (",s.length,")"]}),e.jsx(R,{className:"mt-1",children:"Manage vocabulary words and their translations"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Words"}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:s.length})]})]})}),e.jsx(Q,{children:e.jsxs(Ue,{children:[e.jsx(Oe,{children:e.jsxs(J,{children:[e.jsx(T,{children:"Word"}),e.jsx(T,{children:"Translation"}),e.jsx(T,{children:"Example"}),e.jsx(T,{children:"Media"}),e.jsx(T,{className:"w-[70px]",children:"Actions"})]})}),e.jsx(We,{children:s.map(i=>e.jsxs(J,{children:[e.jsx(k,{className:"max-w-[200px]",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium truncate",title:i.word,children:i.word}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["ID: #",i.id]})]})}),e.jsx(k,{className:"max-w-[200px]",children:e.jsx("div",{className:"font-medium text-green-600 truncate",title:i.translation,children:i.translation})}),e.jsx(k,{className:"max-w-[300px]",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground truncate",title:i.example_sentence,children:i.example_sentence}),i.example_audio&&e.jsxs(N,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:()=>v(i.example_audio),children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),"Play Example"]})]})}),e.jsx(k,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[i.audio_url&&e.jsx(N,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>v(i.audio_url),title:"Play audio",children:e.jsx(fe,{className:"h-4 w-4 text-blue-600"})}),i.image_url&&e.jsx(N,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>window.open(ae(i.image_url),"_blank"),title:"View image",children:e.jsx(ke,{className:"h-4 w-4 text-green-600"})}),!i.audio_url&&!i.image_url&&e.jsx(pe,{variant:"outline",className:"text-xs",children:"No media"})]})}),e.jsx(k,{children:e.jsxs(Pe,{children:[e.jsx(Be,{asChild:!0,children:e.jsxs(N,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(Ie,{className:"h-4 w-4"})]})}),e.jsxs(Ke,{align:"end",children:[e.jsx(Ve,{children:"Actions"}),e.jsxs(Y,{onClick:()=>p(i),children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(Y,{onClick:()=>x(i),className:"text-red-600",children:[e.jsx(Me,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},i.id))})]})})]}),e.jsx(ze,{open:g,onOpenChange:o,title:"Delete Word",desc:`Are you sure you want to delete "${n?.word}"? This action cannot be undone.`,confirmText:"Delete",handleConfirm:f,isLoading:c.isPending})]})}function Ne({onGenerate:s,children:y,queryKey:p,disabled:w=!1}){const g=M(),o=P({mutationFn:s,onSuccess:l=>{S.success(l.message||"Audio generated successfully"),p&&g.invalidateQueries({queryKey:p})},onError:l=>{S.error("Failed to generate audio"),console.error("Audio generation error:",l)}}),n=()=>{o.mutate()};return e.jsx(N,{type:"button",variant:"outline",size:"sm",onClick:n,disabled:w||o.isPending,className:"flex items-center gap-2",children:o.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}),"Generating..."]}):y||e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"h-4 w-4"}),"Generate"]})})}function ge({onUpload:s,accept:y,children:p,queryKey:w,disabled:g=!1}){const o=j.useRef(null),n=M(),l=P({mutationFn:async x=>{console.log("Starting upload for file:",x.name,"Size:",x.size,"Type:",x.type);try{const f=await s(x);return console.log("Upload successful:",f),f}catch(f){throw console.error("Upload failed:",f),f}},onSuccess:x=>{console.log("Upload success handler:",x),S.success(x.message||"File uploaded successfully"),w&&n.invalidateQueries({queryKey:w})},onError:x=>{console.error("Upload error handler:",x);const f=x?.response?.data?.detail||x?.message||"Failed to upload file";S.error(f)}}),d=x=>{const f=x.target.files?.[0];if(f){if(f.size>10*1024*1024){S.error("File size must be less than 10MB");return}l.mutate(f)}x.target.value=""},c=()=>{o.current?.click()};return e.jsxs(e.Fragment,{children:[e.jsx(N,{type:"button",variant:"outline",size:"sm",onClick:c,disabled:g||l.isPending,className:"flex items-center gap-2",children:l.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}),"Uploading..."]}):p||e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"h-4 w-4"}),"Upload"]})}),e.jsx("input",{ref:o,type:"file",accept:y,onChange:d,className:"hidden"})]})}const dt=ye({word:K().min(1,"Word is required"),translation:K().min(1,"Translation is required"),example_sentence:K().min(1,"Example sentence is required")});function ct({lessonId:s,children:y,onSuccess:p}){const[w,g]=j.useState(!1),[o,n]=j.useState(null),[l,d]=j.useState("Betty"),[c,x]=j.useState("Betty"),f=M(),v=ve({resolver:be(dt),defaultValues:{word:"",translation:"",example_sentence:""}}),i=P({mutationFn:t=>b.words.create({...t,lesson_id:s,audio_url:null,image_url:null,example_audio:null}),onSuccess:t=>{S.success("Word created successfully"),f.invalidateQueries({queryKey:["words",s]}),n(t.id),v.reset(),p?.()},onError:t=>{S.error("Failed to create word"),console.error("Create word error:",t)}}),a=t=>{i.mutate(t)},h=t=>{g(t),t||(n(null),d("Betty"),x("Betty"),v.reset())};return e.jsxs(oe,{open:w,onOpenChange:h,children:[e.jsx(Ge,{asChild:!0,children:y||e.jsxs(N,{children:[e.jsx(ss,{className:"h-4 w-4"}),"Add Word"]})}),e.jsxs(de,{className:"sm:max-w-[600px]",children:[e.jsxs(ce,{children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5"}),"Create New Word"]}),e.jsx(he,{children:"Add a new vocabulary word with translation and example sentence."})]}),e.jsx(we,{...v,children:e.jsxs("form",{onSubmit:v.handleSubmit(a),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(D,{control:v.control,name:"word",render:({field:t})=>e.jsxs(F,{children:[e.jsx(A,{children:"Word *"}),e.jsx(E,{children:e.jsx($,{placeholder:"e.g., hello",...t})}),e.jsx(q,{})]})}),e.jsx(D,{control:v.control,name:"translation",render:({field:t})=>e.jsxs(F,{children:[e.jsx(A,{children:"Translation *"}),e.jsx(E,{children:e.jsx($,{placeholder:"e.g., salom",...t})}),e.jsx(q,{})]})})]}),e.jsx(D,{control:v.control,name:"example_sentence",render:({field:t})=>e.jsxs(F,{children:[e.jsx(A,{children:"Example Sentence *"}),e.jsx(E,{children:e.jsx(Ce,{placeholder:"Hello, how are you?",className:"min-h-[80px]",...t})}),e.jsx(q,{})]})}),o&&e.jsx("div",{className:"grid gap-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-green-600",children:"✓ Word Created! Add Media (Optional)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Word Audio"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ee,{value:l,onValueChange:d,children:[e.jsx(se,{className:"w-48",children:e.jsx(te,{})}),e.jsxs(ne,{children:[e.jsx(U,{value:"Betty",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"🇺🇸"}),"Betty"]})}),e.jsx(U,{value:"default",children:"Default"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ne,{onGenerate:()=>b.words.generateAudio(o,l==="default"?null:l),queryKey:["words",s],children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Generate"]}),e.jsxs(ge,{accept:"audio/mp3,audio/mpeg,audio/*",onUpload:t=>b.words.uploadAudio(o,t),queryKey:["words",s],children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Upload Audio"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Word Image"}),e.jsxs(ge,{accept:"image/jpeg,image/png,image/jpg,image/*",onUpload:t=>b.words.uploadImage(o,t),queryKey:["words",s],children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Upload Image"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Example Audio"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ee,{value:c,onValueChange:x,children:[e.jsx(se,{className:"w-48",children:e.jsx(te,{})}),e.jsxs(ne,{children:[e.jsx(U,{value:"Betty",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"🇺🇸"}),"Betty"]})}),e.jsx(U,{value:"default",children:"Default"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ne,{onGenerate:()=>b.words.generateExampleAudio(o,c==="default"?null:c),queryKey:["words",s],children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Generate"]}),e.jsxs(ge,{accept:"audio/mp3,audio/mpeg,audio/*",onUpload:t=>b.words.uploadExampleAudio(o,t),queryKey:["words",s],children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Upload Audio"]})]})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Media upload is optional. You can add or update media files later by editing the word."})]})})]}),e.jsxs(me,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>g(!1),children:o?"Done":"Cancel"}),!o&&e.jsx(N,{type:"submit",disabled:i.isPending,className:"min-w-[120px]",children:i.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creating..."]}):"Create Word"})]})]})})]})]})}const xt=ye({word:K().min(1,"Word is required"),translation:K().min(1,"Translation is required"),example_sentence:K().min(1,"Example sentence is required")});function ht({word:s,open:y,onOpenChange:p,onSuccess:w}){const g=M(),o=ve({resolver:be(xt),defaultValues:{word:"",translation:"",example_sentence:""}}),n=P({mutationFn:d=>{if(!s)throw new Error("No word selected");return b.words.update(s.id,d)},onSuccess:()=>{S.success("Word updated successfully"),g.invalidateQueries({queryKey:["words",s?.lesson_id]}),p(!1),w?.()},onError:d=>{S.error("Failed to update word"),console.error("Update word error:",d)}});j.useEffect(()=>{s&&o.reset({word:s.word,translation:s.translation,example_sentence:s.example_sentence})},[s,o]);const l=d=>{n.mutate(d)};return s?e.jsx(oe,{open:y,onOpenChange:p,children:e.jsxs(de,{className:"sm:max-w-[600px]",children:[e.jsxs(ce,{children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"Edit Word"]}),e.jsx(he,{children:"Update the word information, translation, and example sentence."})]}),e.jsx(we,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(l),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(D,{control:o.control,name:"word",render:({field:d})=>e.jsxs(F,{children:[e.jsx(A,{children:"Word *"}),e.jsx(E,{children:e.jsx($,{placeholder:"e.g., hello",...d})}),e.jsx(q,{})]})}),e.jsx(D,{control:o.control,name:"translation",render:({field:d})=>e.jsxs(F,{children:[e.jsx(A,{children:"Translation *"}),e.jsx(E,{children:e.jsx($,{placeholder:"e.g., salom",...d})}),e.jsx(q,{})]})})]}),e.jsx(D,{control:o.control,name:"example_sentence",render:({field:d})=>e.jsxs(F,{children:[e.jsx(A,{children:"Example Sentence *"}),e.jsx(E,{children:e.jsx(Ce,{placeholder:"Hello, how are you?",className:"min-h-[80px]",...d})}),e.jsx(q,{})]})}),e.jsx("div",{className:"grid gap-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Media Management"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Word Audio"}),s?.audio_url&&e.jsx(N,{type:"button",variant:"ghost",size:"sm",onClick:()=>{new Audio(ae(s.audio_url)).play().catch(console.error)},children:e.jsx(fe,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ne,{onGenerate:()=>b.words.generateAudio(s.id,null),queryKey:["words",s?.lesson_id],children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Generate"]}),e.jsxs(ge,{accept:"audio/mp3,audio/mpeg,audio/*",onUpload:d=>b.words.uploadAudio(s.id,d),queryKey:["words",s?.lesson_id],children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Upload Audio"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Word Image"}),s?.image_url&&e.jsx(N,{type:"button",variant:"ghost",size:"sm",onClick:()=>window.open(ae(s.image_url),"_blank"),children:e.jsx(ke,{className:"h-4 w-4"})})]}),e.jsxs(ge,{accept:"image/jpeg,image/png,image/jpg,image/*",onUpload:d=>b.words.uploadImage(s.id,d),queryKey:["words",s?.lesson_id],children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),s?.image_url?"Replace Image":"Upload Image"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Example Audio"}),s?.example_audio&&e.jsx(N,{type:"button",variant:"ghost",size:"sm",onClick:()=>{new Audio(ae(s.example_audio)).play().catch(console.error)},children:e.jsx(fe,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ne,{onGenerate:()=>b.words.generateExampleAudio(s.id,null),queryKey:["words",s?.lesson_id],children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Generate"]}),e.jsxs(ge,{accept:"audio/mp3,audio/mpeg,audio/*",onUpload:d=>b.words.uploadExampleAudio(s.id,d),queryKey:["words",s?.lesson_id],children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Upload Audio"]})]})]})]})})]}),e.jsxs(me,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(N,{type:"submit",disabled:n.isPending,className:"min-w-[120px]",children:n.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Updating..."]}):"Update Word"})]})]})})]})}):null}function mt({data:s,isLoading:y,onEdit:p,onRefresh:w,lessonId:g}){const[o,n]=j.useState(!1),[l,d]=j.useState(null),c=M(),x=[...new Set(s.filter(m=>m.word_lesson_id).map(m=>m.word_lesson_id))],{data:f}=Z({queryKey:["word-lessons-by-ids",x],queryFn:async()=>x.length===0?[]:await Promise.all(x.map(O=>b.lessons.get(O))),enabled:x.length>0}),v=new Map(f?.map(m=>[m.id,m])||[]),i=P({mutationFn:m=>b.stories.delete(m),onSuccess:m=>{S.success(m.message),c.invalidateQueries({queryKey:["stories"]}),w(),n(!1),d(null)},onError:m=>{S.error("Failed to delete story"),console.error("Delete error:",m)}}),a=m=>{d(m),n(!0)},h=()=>{l&&i.mutate(l.id)},t=m=>{if(m){const O=ae(m);O&&new Audio(O).play().catch(C=>{console.error("Error playing audio:",C),S.error("Failed to play audio")})}};return y?e.jsxs(V,{children:[e.jsxs(z,{children:[e.jsx(G,{children:"Stories"}),e.jsx(R,{children:"Loading..."})]}),e.jsx(Q,{children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):s.length===0?e.jsxs(V,{children:[e.jsxs(z,{children:[e.jsx(G,{children:"Stories"}),e.jsx(R,{children:"No stories found"})]}),e.jsx(Q,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(Fe,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsxs("p",{className:"text-muted-foreground text-center",children:["No stories have been created yet.",e.jsx("br",{}),'Click "Add Story" to get started.']})]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(V,{className:"border-0 shadow-lg bg-gradient-to-br from-card via-card to-card/95",children:[e.jsx(z,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(G,{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(Fe,{className:"h-5 w-5 text-primary"}),"Stories (",s.length,")"]}),e.jsx(R,{className:"mt-1",children:"Manage story content for this lesson"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Stories"}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:s.length})]})]})}),e.jsx(Q,{children:e.jsxs(Ue,{children:[e.jsx(Oe,{children:e.jsxs(J,{children:[e.jsx(T,{children:"Story Text"}),e.jsx(T,{children:"Word Lesson"}),e.jsx(T,{children:"Audio"}),e.jsx(T,{className:"w-[70px]",children:"Actions"})]})}),e.jsx(We,{children:s.map(m=>e.jsxs(J,{children:[e.jsx(k,{className:"max-w-[500px]",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm text-muted-foreground",style:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},title:m.story_text,children:m.story_text}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["ID: #",m.id," • ",m.story_text.length," characters"]})]})}),e.jsx(k,{children:m.word_lesson_id?e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(pe,{variant:"secondary",className:"text-xs",children:v.get(m.word_lesson_id)?.title||`Lesson #${m.word_lesson_id}`})}):e.jsx(pe,{variant:"outline",className:"text-xs text-muted-foreground",children:"No connection"})}),e.jsx(k,{children:e.jsx("div",{className:"flex items-center gap-2",children:m.audio_url?e.jsx(N,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>t(m.audio_url),title:"Play story audio",children:e.jsx(fe,{className:"h-4 w-4 text-blue-600"})}):e.jsx(pe,{variant:"outline",className:"text-xs",children:"No audio"})})}),e.jsx(k,{children:e.jsxs(Pe,{children:[e.jsx(Be,{asChild:!0,children:e.jsxs(N,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(Ie,{className:"h-4 w-4"})]})}),e.jsxs(Ke,{align:"end",children:[e.jsx(Ve,{children:"Actions"}),e.jsxs(Y,{onClick:()=>p(m),children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(Y,{onClick:()=>a(m),className:"text-red-600",children:[e.jsx(Me,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},m.id))})]})})]}),e.jsx(ze,{open:o,onOpenChange:n,title:"Delete Story",desc:"Are you sure you want to delete this story? This action cannot be undone.",confirmText:"Delete",handleConfirm:h,isLoading:i.isPending})]})}function cs({title:s,description:y,accept:p,maxSize:w=10,onUpload:g,children:o,queryKey:n}){const[l,d]=j.useState(!1),[c,x]=j.useState(null),[f,v]=j.useState(!1),i=j.useRef(null),a=M(),h=P({mutationFn:()=>{if(!c)throw new Error("No file selected");return g(c)},onSuccess:_=>{S.success(_.message),n&&a.invalidateQueries({queryKey:n}),x(null),d(!1)},onError:_=>{S.error("Failed to upload file"),console.error("File upload error:",_)}}),t=_=>{if(_.size>w*1024*1024){S.error(`File size must be less than ${w}MB`);return}x(_)},m=_=>{_.preventDefault(),v(!1);const I=Array.from(_.dataTransfer.files);I.length>0&&t(I[0])},O=_=>{_.preventDefault(),v(!0)},H=_=>{_.preventDefault(),v(!1)},C=_=>{const I=Array.from(_.target.files||[]);I.length>0&&t(I[0])},u=()=>{h.mutate()},L=()=>p.includes("image")?e.jsx(st,{className:"h-8 w-8"}):p.includes("audio")?e.jsx(Js,{className:"h-8 w-8"}):e.jsx(B,{className:"h-8 w-8"}),Re=_=>{if(_===0)return"0 Bytes";const I=1024,ue=["Bytes","KB","MB","GB"],Ae=Math.floor(Math.log(_)/Math.log(I));return parseFloat((_/Math.pow(I,Ae)).toFixed(2))+" "+ue[Ae]};return e.jsxs(oe,{open:l,onOpenChange:d,children:[e.jsx(Ge,{asChild:!0,children:o||e.jsxs(N,{variant:"outline",size:"sm",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Upload File"]})}),e.jsxs(de,{className:"sm:max-w-[500px]",children:[e.jsxs(ce,{children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5"}),s]}),e.jsx(he,{children:y})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsx("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${f?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary/50"}`,onDrop:m,onDragOver:O,onDragLeave:H,children:c?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center justify-center text-green-600",children:L()}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium",children:c.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Re(c.size)})]}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>x(null),children:[e.jsx(Rs,{className:"h-4 w-4 mr-2"}),"Remove"]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center justify-center text-muted-foreground",children:L()}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Drop your file here"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["or click to browse (max ",w,"MB)"]})]}),e.jsx(N,{variant:"outline",onClick:()=>i.current?.click(),children:"Browse Files"})]})}),e.jsx("input",{ref:i,type:"file",accept:p,onChange:C,className:"hidden"})]}),e.jsxs(me,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(N,{type:"button",onClick:u,disabled:!c||h.isPending,className:"min-w-[120px]",children:h.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Upload"]})})]})]})]})}const ut=ye({story_text:K().min(1,"Story text is required"),word_lesson_id:De().optional()});function jt({lessonId:s,chapterId:y,children:p,onSuccess:w}){const[g,o]=j.useState(!1),[n,l]=j.useState(null),[d,c]=j.useState(""),[x,f]=j.useState("Betty"),v=M(),{data:i,isLoading:a}=Z({queryKey:["word-lessons",y],queryFn:async()=>y?(await b.lessons.listByChapter(y)).filter(u=>u.lesson_type==="word"&&u.id!==s):[],enabled:!!y&&g}),h=i?.filter(C=>C.title.toLowerCase().includes(d.toLowerCase()))||[],t=ve({resolver:be(ut),defaultValues:{story_text:"",word_lesson_id:void 0}}),m=P({mutationFn:C=>b.stories.create({...C,lesson_id:s,audio_url:null,word_lesson_id:C.word_lesson_id}),onSuccess:C=>{S.success("Story created successfully"),v.invalidateQueries({queryKey:["stories",s]}),l(C.id),t.reset(),w?.()},onError:C=>{S.error("Failed to create story"),console.error("Create story error:",C)}}),O=C=>{m.mutate(C)},H=C=>{o(C),C||(l(null),c(""),f("Betty"),t.reset())};return e.jsxs(oe,{open:g,onOpenChange:H,children:[e.jsx(Ge,{asChild:!0,children:p||e.jsxs(N,{children:[e.jsx(ss,{className:"h-4 w-4"}),"Add Story"]})}),e.jsxs(de,{className:"sm:max-w-[600px]",children:[e.jsxs(ce,{children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-5 w-5"}),"Create New Story"]}),e.jsx(he,{children:"Add a new story to this lesson with engaging content."})]}),e.jsx(we,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(O),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsx(D,{control:t.control,name:"story_text",render:({field:C})=>e.jsxs(F,{children:[e.jsx(A,{children:"Story Content *"}),e.jsx(E,{children:e.jsx(Ce,{placeholder:"Once upon a time, there was a young student learning English...",className:"min-h-[200px]",...C})}),e.jsx(q,{})]})}),e.jsx(D,{control:t.control,name:"word_lesson_id",render:({field:C})=>e.jsxs(F,{children:[e.jsx(A,{children:"Connect to Word Lesson (Optional)"}),e.jsxs(ee,{onValueChange:u=>C.onChange(u==="none"?void 0:Number(u)),value:C.value?String(C.value):void 0,children:[e.jsx(E,{children:e.jsx(se,{children:e.jsx(te,{placeholder:"Select a word lesson to connect..."})})}),e.jsxs(ne,{children:[e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx($,{placeholder:"Search word lessons...",value:d,onChange:u=>c(u.target.value),className:"pl-10"})]})}),e.jsx(U,{value:"none",children:"No word lesson connection"}),a?e.jsx("div",{className:"p-2 text-center text-sm text-muted-foreground",children:"Loading word lessons..."}):h.length>0?h.map(u=>e.jsx(U,{value:String(u.id),children:u.title},u.id)):e.jsx("div",{className:"p-2 text-center text-sm text-muted-foreground",children:d?"No word lessons found matching your search":"No word lessons available"})]})]}),e.jsx(q,{}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Connect this story to a specific word lesson to reinforce vocabulary learning."})]})}),n&&e.jsx("div",{className:"grid gap-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-green-600",children:"✓ Story Created! Add Audio (Optional)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Story Narration"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ee,{value:x,onValueChange:f,children:[e.jsx(se,{className:"w-48",children:e.jsx(te,{})}),e.jsxs(ne,{children:[e.jsx(U,{value:"Betty",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"🇺🇸"}),"Betty"]})}),e.jsx(U,{value:"default",children:"Default"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ne,{onGenerate:()=>b.stories.generateAudio(n,x==="default"?null:x),queryKey:["stories",s],children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Generate"]}),e.jsx(cs,{title:"Upload Story Audio",description:"Upload an MP3 audio file for story narration.",accept:"audio/mp3,audio/mpeg",onUpload:C=>b.stories.uploadAudio(n,C),queryKey:["stories",s],children:e.jsxs(N,{type:"button",variant:"outline",size:"sm",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Upload"]})})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Generate AI narration or upload your own audio file for this story."})]})]})})]}),e.jsxs(me,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>o(!1),children:n?"Done":"Cancel"}),!n&&e.jsx(N,{type:"submit",disabled:m.isPending,className:"min-w-[120px]",children:m.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creating..."]}):"Create Story"})]})]})})]})]})}const pt=ye({story_text:K().min(1,"Story text is required"),word_lesson_id:De().optional()});function gt({story:s,chapterId:y,open:p,onOpenChange:w,onSuccess:g}){const[o,n]=j.useState(""),l=M(),{data:d,isLoading:c}=Z({queryKey:["word-lessons",y],queryFn:async()=>y?(await b.lessons.listByChapter(y)).filter(h=>h.lesson_type==="word"&&h.id!==s?.lesson_id):[],enabled:!!y&&p}),x=d?.filter(a=>a.title.toLowerCase().includes(o.toLowerCase()))||[],f=ve({resolver:be(pt),defaultValues:{story_text:"",word_lesson_id:void 0}}),v=P({mutationFn:a=>{if(!s)throw new Error("No story selected");return b.stories.update(s.id,a)},onSuccess:()=>{S.success("Story updated successfully"),l.invalidateQueries({queryKey:["stories",s?.lesson_id]}),w(!1),g?.()},onError:a=>{S.error("Failed to update story"),console.error("Update story error:",a)}});j.useEffect(()=>{s&&f.reset({story_text:s.story_text,word_lesson_id:s.word_lesson_id})},[s,f]);const i=a=>{v.mutate(a)};return s?e.jsx(oe,{open:p,onOpenChange:w,children:e.jsxs(de,{className:"sm:max-w-[600px]",children:[e.jsxs(ce,{children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"Edit Story"]}),e.jsx(he,{children:"Update the story content and narration."})]}),e.jsx(we,{...f,children:e.jsxs("form",{onSubmit:f.handleSubmit(i),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsx(D,{control:f.control,name:"story_text",render:({field:a})=>e.jsxs(F,{children:[e.jsx(A,{children:"Story Content *"}),e.jsx(E,{children:e.jsx(Ce,{placeholder:"Once upon a time, there was a young student learning English...",className:"min-h-[200px]",...a})}),e.jsx(q,{})]})}),e.jsx(D,{control:f.control,name:"word_lesson_id",render:({field:a})=>e.jsxs(F,{children:[e.jsx(A,{children:"Connect to Word Lesson (Optional)"}),e.jsxs(ee,{onValueChange:h=>a.onChange(h==="none"?void 0:Number(h)),value:a.value?String(a.value):void 0,children:[e.jsx(E,{children:e.jsx(se,{children:e.jsx(te,{placeholder:"Select a word lesson to connect..."})})}),e.jsxs(ne,{children:[e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx($,{placeholder:"Search word lessons...",value:o,onChange:h=>n(h.target.value),className:"pl-10"})]})}),e.jsx(U,{value:"none",children:"No word lesson connection"}),c?e.jsx("div",{className:"p-2 text-center text-sm text-muted-foreground",children:"Loading word lessons..."}):x.length>0?x.map(h=>e.jsx(U,{value:String(h.id),children:h.title},h.id)):e.jsx("div",{className:"p-2 text-center text-sm text-muted-foreground",children:o?"No word lessons found matching your search":"No word lessons available"})]})]}),e.jsx(q,{}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Connect this story to a specific word lesson to reinforce vocabulary learning."})]})}),e.jsx("div",{className:"grid gap-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Audio Management"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Story Narration"}),s?.audio_url&&e.jsx(N,{type:"button",variant:"ghost",size:"sm",onClick:()=>{new Audio(ae(s.audio_url)).play().catch(console.error)},children:e.jsx(fe,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ne,{onGenerate:()=>b.stories.generateAudio(s.id,null),queryKey:["stories",s?.lesson_id],children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Generate"]}),e.jsx(cs,{title:"Upload Story Audio",description:"Upload an MP3 audio file for story narration.",accept:"audio/mp3,audio/mpeg",onUpload:a=>b.stories.uploadAudio(s.id,a),queryKey:["stories",s?.lesson_id],children:e.jsxs(N,{type:"button",variant:"outline",size:"sm",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Upload"]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Generate AI narration or upload your own audio file for this story."})]})]})})]}),e.jsxs(me,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>w(!1),children:"Cancel"}),e.jsx(N,{type:"submit",disabled:v.isPending,className:"min-w-[120px]",children:v.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Updating..."]}):"Update Story"})]})]})})]})}):null}function ft(){const s=()=>{const r=new URLSearchParams(window.location.search);return{courseId:r.get("courseId")?Number(r.get("courseId")):void 0,chapterId:r.get("chapterId")?Number(r.get("chapterId")):void 0,lessonId:r.get("lessonId")?Number(r.get("lessonId")):void 0,tab:r.get("tab")||"courses"}},y=r=>{const W=new URLSearchParams(window.location.search);Object.entries(r).forEach(([is,es])=>{es==null?W.delete(is):W.set(is,String(es))});const re=`${window.location.pathname}?${W.toString()}`;window.history.pushState({},"",re)},[p,w]=j.useState(null),[g,o]=j.useState(null),[n,l]=j.useState(null),[d,c]=j.useState(!1),[x,f]=j.useState(!1),[v,i]=j.useState(!1),[a,h]=j.useState(!1),[t,m]=j.useState(null),[O,H]=j.useState(!1),[C,u]=j.useState(null),[L,Re]=j.useState(""),[_,I]=j.useState("courses"),{data:ue=[],isLoading:Ae,refetch:xs}=Z({queryKey:["courses"],queryFn:()=>b.courses.list()}),Qe=p?.id,{data:Ee=[],isLoading:hs,refetch:ms}=Z({queryKey:["chapters",Qe],queryFn:()=>b.chapters.listByCourse(Qe),enabled:!!Qe}),$e=g?.id,{data:qe=[],isLoading:us,refetch:js}=Z({queryKey:["lessons",$e],queryFn:()=>b.lessons.listByChapter($e),enabled:!!$e}),je=n?.id,{data:ps=[],isLoading:gs,refetch:fs}=Z({queryKey:["words",je],queryFn:()=>b.words.listByLesson(je),enabled:!!je}),{data:Ns=[],isLoading:ys,refetch:ws}=Z({queryKey:["stories",je],queryFn:()=>b.stories.listByLesson(je),enabled:!!je});j.useEffect(()=>{const r=s();I(r.tab)},[]),j.useEffect(()=>{const r=s();if(ue.length>0&&r.courseId){const W=ue.find(re=>re.id===r.courseId);W&&w(W)}},[ue]),j.useEffect(()=>{const r=s();if(Ee.length>0&&r.chapterId){const W=Ee.find(re=>re.id===r.chapterId);W&&o(W)}},[Ee]),j.useEffect(()=>{const r=s();if(qe.length>0&&r.lessonId){const W=qe.find(re=>re.id===r.lessonId);W&&l(W)}},[qe]);const vs=r=>{w(r),c(!0)},bs=r=>{o(r),f(!0)},Cs=r=>{l(r),i(!0)},Ss=r=>{m(r),h(!0)},Ls=r=>{u(r),H(!0)},_s=r=>{if(r.lesson_type==="test")return;l(r);const W=r.lesson_type==="word"?"words":r.lesson_type==="story"?"story":"words";I(W),y({lessonId:r.id,tab:W})},Ds=r=>{w(r),I("chapters"),y({courseId:r.id,chapterId:void 0,lessonId:void 0,tab:"chapters"})},Fs=r=>{o(r),I("lessons"),y({chapterId:r.id,lessonId:void 0,tab:"lessons"})},He=()=>{xs()},Ze=()=>{ms()},Xe=()=>{js()},Ye=()=>{fs()},Je=()=>{ws()},ns=ue.filter(r=>r.title.toLowerCase().includes(L.toLowerCase())||r.native_language.toLowerCase().includes(L.toLowerCase())||r.learning_language.toLowerCase().includes(L.toLowerCase())),rs=Ee.filter(r=>r.title.toLowerCase().includes(L.toLowerCase())),as=qe.filter(r=>r.title.toLowerCase().includes(L.toLowerCase())||r.content.toLowerCase().includes(L.toLowerCase())),ls=ps.filter(r=>r.word.toLowerCase().includes(L.toLowerCase())||r.translation.toLowerCase().includes(L.toLowerCase())||r.example_sentence.toLowerCase().includes(L.toLowerCase())),As=Ns.filter(r=>r.story_text.toLowerCase().includes(L.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsxs(Us,{children:[e.jsx(Es,{links:Nt}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(Os,{}),e.jsx(Ws,{}),e.jsx(Is,{}),e.jsx(Ms,{})]})]}),e.jsxs(qs,{children:[e.jsx("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"Zehnly Duo Management"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Complete language learning content management system"})]})}),e.jsx("div",{className:"mb-6",children:e.jsx($,{placeholder:"Search across all content...",value:L,onChange:r=>Re(r.target.value),className:"max-w-sm"})}),e.jsxs(Ts,{value:_,onValueChange:r=>{I(r),y({tab:r})},className:"space-y-6",children:[e.jsxs(ks,{className:"grid w-full grid-cols-5",children:[e.jsxs(Se,{value:"courses",className:"flex items-center gap-2",children:[e.jsx(Qs,{className:"h-4 w-4"}),"Courses (",ns.length,")"]}),e.jsxs(Se,{value:"chapters",className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),"Chapters (",rs.length,")"]}),e.jsxs(Se,{value:"lessons",className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"Lessons (",as.length,")"]}),e.jsxs(Se,{value:"words",className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-4 w-4"}),"Words (",ls.length,")"]}),e.jsxs(Se,{value:"story",className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),"Story Content"]})]}),e.jsxs(Le,{value:"courses",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Courses"}),e.jsx(Bs,{onSuccess:He,children:e.jsxs(N,{children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),"Add Course"]})})]}),e.jsx(tt,{data:ns,isLoading:Ae,onEdit:vs,onCourseClick:Ds,onRefresh:He,selectedCourse:p})]}),e.jsxs(Le,{value:"chapters",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Chapters"}),p&&e.jsxs("p",{className:"text-muted-foreground",children:[p.title," • ",p.native_language," → ",p.learning_language]})]}),p&&e.jsx(Hs,{courseId:p.id,onSuccess:Ze,children:e.jsxs(N,{children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),"Add Chapter"]})})]}),p?e.jsx(Zs,{data:rs,isLoading:hs,onEdit:bs,onChapterClick:Fs,onRefresh:Ze,selectedChapter:g}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Select a course from the Courses tab to view its chapters"})]}),e.jsxs(Le,{value:"lessons",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Lessons"}),g&&e.jsxs("p",{className:"text-muted-foreground",children:[g.title," • Order ",g.order]})]}),g&&e.jsx(at,{chapterId:g.id,onSuccess:Xe,children:e.jsxs(N,{children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),"Add Lesson"]})})]}),g?e.jsx(nt,{data:as,isLoading:us,onEdit:Cs,onLessonClick:_s,onRefresh:Xe,selectedLesson:n}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Select a chapter from the Chapters tab to view its lessons"})]}),e.jsxs(Le,{value:"words",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Words"}),n&&e.jsxs("p",{className:"text-muted-foreground",children:[n.title," • ",n.lesson_type," lesson • Order ",n.order]})]}),n&&e.jsx(ct,{lessonId:n.id,onSuccess:Ye,children:e.jsxs(N,{children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),"Add Word"]})})]}),n?e.jsx(ot,{data:ls,isLoading:gs,onEdit:Ss,onRefresh:Ye}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Select a lesson from the Lessons tab to view its vocabulary words"})]}),e.jsxs(Le,{value:"story",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Story Management"}),n&&e.jsxs("p",{className:"text-muted-foreground",children:[n.title," • Story lesson • Order ",n.order]})]}),n&&n.lesson_type==="story"&&g&&e.jsx(jt,{lessonId:n.id,chapterId:g.id,onSuccess:Je,children:e.jsxs(N,{children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),"Add Story"]})})]}),n&&n.lesson_type==="story"?e.jsx(mt,{data:As,isLoading:ys,onEdit:Ls,onRefresh:Je,lessonId:n.id}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Select a story lesson from the Lessons tab to manage its stories"})]})]})]}),e.jsx(Ks,{course:p,open:d,onOpenChange:c,onSuccess:He}),e.jsx(Xs,{chapter:g,open:x,onOpenChange:f,onSuccess:Ze}),e.jsx(it,{lesson:n,open:v,onOpenChange:i,onSuccess:Xe}),e.jsx(ht,{word:t,open:a,onOpenChange:h,onSuccess:Ye}),e.jsx(gt,{story:C,chapterId:g?.id,open:O,onOpenChange:H,onSuccess:Je})]})}const Nt=[{title:"Zehnly Duo",href:"/zehnly-duo",isActive:!0,disabled:!1}],It=ft;export{It as component};
