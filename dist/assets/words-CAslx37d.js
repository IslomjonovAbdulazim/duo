import{r as u,d as je,t as w,j as e,B as m,c as re,u as ss,v as as}from"./index-C1dgz4Nm.js";import{u as R,B as W,T as rs,a as ns,b as Pe,c as G,d as ls,e as X,f as qe,M as Ae}from"./badge-z_9uRZcm.js";import{C as B,a as ie,b as de,c as ce,d as V}from"./card-CuBB0wwQ.js";import{u as ze,a as Ge,I as H}from"./label-tLKrJ59s.js";import{S as me,a as xe,b as he,c as ue,d as Y}from"./select-D0SXxeg-.js";import{c as ts,d as Q,u as is,C as ds,a as be,S as ne,b as Ce,P as cs,e as os,f as ms,g as xs,h as hs,i as us,j as js,k as ps,l as fs}from"./schema-D1UBJ9rY.js";import{D as gs,c as vs,d as Ns,e as ws,f as Me,C as ys,H as Ue,T as Je,P as Be,A as Se,a as De,b as ke,k as bs}from"./theme-switch-D0Hy7_tu.js";import{S as Ve,C as He}from"./config-drawer-B0PCMMZk.js";import{c as P,C as Cs,F as Ke,b as Ie}from"./content-api-DvAdUDEe.js";import{l as Ss}from"./learning-centers-api-BadADc8O.js";import{a as Ds,g as Le}from"./media-utils-Cpm_6zhn.js";import{u as Te,D as pe,a as Xe,b as fe,c as ge,d as ve,e as We,F as Ye,f as k,g as I,h as L,i as _,j as E,k as Oe,S as Ze,E as ks,T as Is}from"./form-B718r0vi.js";import{T as Z,a as Ls,b as _s,c as le,d as te}from"./textarea-tRQgj_rq.js";import{T as _e,V as Ee}from"./volume-2-CtBuKig6.js";import{I as es}from"./image-Ym2dUXg7.js";import{B as oe}from"./book-open-CiSIWzRy.js";import{P as Es}from"./progress-ChUM3ypB.js";import{D as Fe}from"./download-DO7CVXU5.js";import{c as Ts}from"./createLucideIcon-DdqFu-CR.js";import{S as Ws}from"./index-BEZ9X4Al.js";import{G as Os}from"./graduation-cap-CXEJUreh.js";import{P as Fs}from"./plus-DGrcXmiQ.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Ps=Ts("external-link",$s);function qs({lessonId:d,children:y,onSuccess:b}){const[f,h]=u.useState(!1),x=je(),c=ze({resolver:Ge(ts),defaultValues:{word:"",translation:"",definition:"",sentence:"",difficulty:"easy",order:1}}),{data:g,isLoading:T}=R({queryKey:["lessons"],queryFn:()=>P.lessons.list(),enabled:!d}),C=Te({mutationFn:t=>P.words.create({lesson_id:t.lessonId,word:t.word,translation:t.translation,example_sentence:t.sentence||t.definition||"",audio_url:null,image_url:null,example_audio:null}),onSuccess:()=>{w.success("Word created successfully"),x.invalidateQueries({queryKey:["words"]}),x.invalidateQueries({queryKey:["lessons"]}),c.reset(),h(!1),b?.()},onError:t=>{w.error("Failed to create word"),console.error("Create word error:",t)}}),n=t=>{const i=d||parseInt(c.watch("lessonId"));if(!i){w.error("Please select a lesson");return}C.mutate({...t,lessonId:i})};return e.jsxs(pe,{open:f,onOpenChange:h,children:[e.jsx(Xe,{asChild:!0,children:y||e.jsxs(m,{children:[e.jsx(Cs,{className:"h-4 w-4"}),"Add Word"]})}),e.jsxs(fe,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(ge,{children:[e.jsxs(ve,{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5"}),"Create New Word"]}),e.jsx(We,{children:"Add a new vocabulary word with translation, definition, and example usage."})]}),e.jsx(Ye,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(n),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[!d&&e.jsx(k,{control:c.control,name:"lessonId",render:({field:t})=>e.jsxs(I,{children:[e.jsx(L,{children:"Lesson *"}),e.jsxs(me,{onValueChange:i=>t.onChange(parseInt(i)),value:t.value?.toString(),disabled:T,children:[e.jsx(_,{children:e.jsx(xe,{children:e.jsx(he,{placeholder:"Select a lesson"})})}),e.jsx(ue,{children:g?.map(i=>e.jsx(Y,{value:i.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${i.is_active?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"font-medium",children:i.title}),i.course_title&&e.jsxs("span",{className:"text-muted-foreground text-sm",children:["(",i.course_title,")"]})]})},i.id))})]}),e.jsx(E,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(k,{control:c.control,name:"word",render:({field:t})=>e.jsxs(I,{children:[e.jsx(L,{children:"Word *"}),e.jsx(_,{children:e.jsx(H,{placeholder:"e.g., hello",...t})}),e.jsx(E,{})]})}),e.jsx(k,{control:c.control,name:"translation",render:({field:t})=>e.jsxs(I,{children:[e.jsx(L,{children:"Translation *"}),e.jsx(_,{children:e.jsx(H,{placeholder:"e.g., salom",...t})}),e.jsx(E,{})]})})]}),e.jsx(k,{control:c.control,name:"definition",render:({field:t})=>e.jsxs(I,{children:[e.jsx(L,{children:"Definition *"}),e.jsx(_,{children:e.jsx(Z,{placeholder:"Provide a clear definition of the word...",className:"min-h-[80px]",...t})}),e.jsx(E,{})]})}),e.jsx(k,{control:c.control,name:"sentence",render:({field:t})=>e.jsxs(I,{children:[e.jsx(L,{children:"Example Sentence *"}),e.jsx(_,{children:e.jsx(Z,{placeholder:"Write an example sentence using this word...",className:"min-h-[80px]",...t})}),e.jsx(E,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(k,{control:c.control,name:"difficulty",render:({field:t})=>e.jsxs(I,{children:[e.jsx(L,{children:"Difficulty Level *"}),e.jsxs(me,{onValueChange:t.onChange,value:t.value,children:[e.jsx(_,{children:e.jsx(xe,{children:e.jsx(he,{placeholder:"Select difficulty"})})}),e.jsx(ue,{children:Q.map(i=>e.jsx(Y,{value:i.value,children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(W,{variant:"secondary",className:`text-xs ${i.color} border-0`,children:i.label})})},i.value))})]}),e.jsx(E,{})]})}),e.jsx(k,{control:c.control,name:"order",render:({field:t})=>e.jsxs(I,{children:[e.jsx(L,{children:"Order *"}),e.jsx(_,{children:e.jsx(H,{type:"number",min:"1",placeholder:"1",...t,onChange:i=>t.onChange(parseInt(i.target.value)||1)})}),e.jsx(E,{})]})})]}),e.jsx("div",{className:"bg-muted/50 border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(es,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-muted-foreground mb-1",children:"Audio & Image Upload"}),e.jsx("p",{className:"text-muted-foreground",children:"You can upload audio pronunciation and images after creating the word. Use the edit menu to add media files."})]})]})})]}),e.jsxs(Oe,{children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(m,{type:"submit",disabled:C.isPending,className:"min-w-[100px]",children:C.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creating..."]}):"Create Word"})]})]})})]})]})}function As({word:d,open:y,onOpenChange:b,onSuccess:f}){const h=je(),x=ze({resolver:Ge(is),defaultValues:{word:"",translation:"",definition:"",sentence:"",difficulty:"easy",order:1}}),{data:c}=R({queryKey:["lessons"],queryFn:()=>P.lessons.list()}),g=Te({mutationFn:n=>{if(!d)throw new Error("No word selected");return P.words.update(d.id,n)},onSuccess:()=>{w.success("Word updated successfully"),h.invalidateQueries({queryKey:["words"]}),h.invalidateQueries({queryKey:["lessons"]}),b(!1),f?.()},onError:n=>{w.error("Failed to update word"),console.error("Update word error:",n)}});u.useEffect(()=>{d&&x.reset({word:d.word,translation:d.translation,definition:d.example_sentence||"",sentence:d.example_sentence||"",difficulty:"easy",order:1})},[d,x]);const T=n=>{g.mutate(n)};if(!d)return null;const C=c?.find(n=>n.id===d.lesson_id);return e.jsx(pe,{open:y,onOpenChange:b,children:e.jsxs(fe,{className:"sm:max-w-[700px]",children:[e.jsxs(ge,{children:[e.jsxs(ve,{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-5 w-5"}),"Edit Word"]}),e.jsx(We,{children:"Update the word information and content."})]}),e.jsx(Ye,{...x,children:e.jsxs("form",{onSubmit:x.handleSubmit(T),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(k,{control:x.control,name:"word",render:({field:n})=>e.jsxs(I,{children:[e.jsx(L,{children:"Word *"}),e.jsx(_,{children:e.jsx(H,{placeholder:"e.g., Hello",...n})}),e.jsx(E,{})]})}),e.jsx(k,{control:x.control,name:"translation",render:({field:n})=>e.jsxs(I,{children:[e.jsx(L,{children:"Translation *"}),e.jsx(_,{children:e.jsx(H,{placeholder:"e.g., Hola",...n})}),e.jsx(E,{})]})})]}),e.jsx(k,{control:x.control,name:"definition",render:({field:n})=>e.jsxs(I,{children:[e.jsx(L,{children:"Definition *"}),e.jsx(_,{children:e.jsx(Z,{placeholder:"Explain what this word means...",className:"min-h-[80px]",...n})}),e.jsx(E,{})]})}),e.jsx(k,{control:x.control,name:"sentence",render:({field:n})=>e.jsxs(I,{children:[e.jsx(L,{children:"Example Sentence"}),e.jsx(_,{children:e.jsx(Z,{placeholder:"Provide an example sentence using this word...",className:"min-h-[80px]",...n})}),e.jsx(E,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(k,{control:x.control,name:"difficulty",render:({field:n})=>e.jsxs(I,{children:[e.jsx(L,{children:"Difficulty Level *"}),e.jsxs(me,{onValueChange:n.onChange,value:n.value,children:[e.jsx(_,{children:e.jsx(xe,{children:e.jsx(he,{placeholder:"Select difficulty"})})}),e.jsx(ue,{children:Q.map(t=>e.jsx(Y,{value:t.value,children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(W,{variant:"secondary",className:`text-xs ${t.color} border-0`,children:t.label})})},t.value))})]}),e.jsx(E,{})]})}),e.jsx(k,{control:x.control,name:"order",render:({field:n})=>e.jsxs(I,{children:[e.jsx(L,{children:"Order *"}),e.jsx(_,{children:e.jsx(H,{type:"number",min:"1",placeholder:"1",...n,onChange:t=>n.onChange(parseInt(t.target.value)||1)})}),e.jsx(E,{})]})})]}),e.jsxs("div",{className:"bg-muted/50 border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(oe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium text-sm",children:"Current Lesson"})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:C?.title||`Lesson ${d.lesson_id}`}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Note: To move this word to a different lesson, please create a new word in the target lesson."})]})]}),e.jsxs(Oe,{children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>b(!1),children:"Cancel"}),e.jsx(m,{type:"submit",disabled:g.isPending,className:"min-w-[100px]",children:g.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Updating..."]}):"Update Word"})]})]})})]})})}const Re=`[
  {
    "word": "Hello",
    "translation": "Hola",
    "definition": "A greeting used when meeting someone or starting a conversation",
    "sentence": "Hello, how are you today?",
    "difficulty": "easy",
    "order": 1
  },
  {
    "word": "Goodbye",
    "translation": "Adiós",
    "definition": "A farewell expression used when leaving or ending a conversation",
    "sentence": "Goodbye, see you tomorrow!",
    "difficulty": "easy",
    "order": 2
  },
  {
    "word": "Beautiful",
    "translation": "Hermoso",
    "definition": "Pleasing to the senses or mind; having qualities that give great pleasure",
    "sentence": "The sunset was absolutely beautiful.",
    "difficulty": "medium",
    "order": 3
  },
  {
    "word": "Understand",
    "translation": "Entender",
    "definition": "To perceive the intended meaning of words, language, or a speaker",
    "sentence": "Do you understand what I'm saying?",
    "difficulty": "medium",
    "order": 4
  },
  {
    "word": "Sophisticated",
    "translation": "Sofisticado",
    "definition": "Having or showing a great deal of worldly experience and knowledge",
    "sentence": "She has a very sophisticated taste in art.",
    "difficulty": "hard",
    "order": 5
  }
]`;function Ms({lessonId:d,lessonName:y,children:b,onSuccess:f}){const[h,x]=u.useState(!1),[c,g]=u.useState(""),[T,C]=u.useState([]),[n,t]=u.useState([]),[i,q]=u.useState([]),[a,v]=u.useState("input"),[A,O]=u.useState(0),U=je(),F=l=>{const r=[];if(!l.trim())return r.push("JSON input is required"),{valid:!1,errors:r};try{const o=JSON.parse(l);if(!Array.isArray(o))return r.push("JSON must be an array of word objects"),{valid:!1,errors:r};if(o.length===0)return r.push("Array cannot be empty"),{valid:!1,errors:r};if(o.length>100)return r.push("Maximum 100 words allowed per bulk creation"),{valid:!1,errors:r};const S=[],p=new Set,$=new Set;return o.forEach((J,s)=>{if(typeof J!="object"||J===null){r.push(`Item ${s+1}: Must be an object`);return}const{word:j,translation:D,definition:N,sentence:K,difficulty:ae,order:M}=J;!j||typeof j!="string"?r.push(`Item ${s+1}: "word" is required and must be a string`):j.length>100?r.push(`Item ${s+1}: "word" must be less than 100 characters`):$.has(j.toLowerCase())?r.push(`Item ${s+1}: "word" "${j}" is duplicated`):$.add(j.toLowerCase()),!D||typeof D!="string"?r.push(`Item ${s+1}: "translation" is required and must be a string`):D.length>100&&r.push(`Item ${s+1}: "translation" must be less than 100 characters`),!N||typeof N!="string"?r.push(`Item ${s+1}: "definition" is required and must be a string`):N.length>1e3&&r.push(`Item ${s+1}: "definition" must be less than 1000 characters`),K!=null&&(typeof K!="string"?r.push(`Item ${s+1}: "sentence" must be a string`):K.length>500&&r.push(`Item ${s+1}: "sentence" must be less than 500 characters`));const $e=["easy","medium","hard"];(!ae||!$e.includes(ae))&&r.push(`Item ${s+1}: "difficulty" must be one of: ${$e.join(", ")}`),typeof M!="number"||M<1?r.push(`Item ${s+1}: "order" must be a positive number`):p.has(M)?r.push(`Item ${s+1}: "order" ${M} is duplicated`):p.add(M),j&&D&&N&&ae&&typeof M=="number"&&M>=1&&S.push({word:j.trim(),translation:D.trim(),definition:N.trim(),sentence:K?K.trim():"",difficulty:ae,order:M})}),{valid:r.length===0,words:S,errors:r}}catch(o){return r.push("Invalid JSON format: "+o.message),{valid:!1,errors:r}}},Ne=()=>{const{valid:l,words:r,errors:o}=F(c);C(o),l&&r&&(t(r),v("preview"))},z=async()=>{v("creating"),O(0);const l=[];for(let S=0;S<n.length;S++){const p=n[S];try{const $=await P.words.create({lesson_id:d,word:p.word,translation:p.translation,example_sentence:p.sentence||p.definition||"",audio_url:null,image_url:null,example_audio:null});l.push({word:p,success:!0,id:$.id}),w.success(`Created word: ${p.word}`)}catch($){l.push({word:p,success:!1,error:$ instanceof Error?$.message:"Unknown error"}),w.error(`Failed to create word: ${p.word}`)}O((S+1)/n.length*100),q([...l])}v("results"),U.invalidateQueries({queryKey:["words"]}),U.invalidateQueries({queryKey:["lessons"]});const r=l.filter(S=>S.success).length,o=l.filter(S=>!S.success).length;r>0&&w.success(`Successfully created ${r} word${r>1?"s":""}`),o>0&&w.error(`Failed to create ${o} word${o>1?"s":""}`),f?.()},ee=()=>{v("input"),g(""),C([]),t([]),q([]),O(0)},we=()=>{navigator.clipboard.writeText(Re),w.success("Example JSON copied to clipboard")},ye=()=>{const l=new Blob([Re],{type:"application/json"}),r=URL.createObjectURL(l),o=document.createElement("a");o.href=r,o.download="words-example.json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r),w.success("Example JSON downloaded")},se=l=>Q.find(r=>r.value===l)||Q[0];return e.jsxs(pe,{open:h,onOpenChange:x,children:[e.jsx(Xe,{asChild:!0,children:b||e.jsxs(m,{variant:"outline",children:[e.jsx(Ke,{className:"h-4 w-4"}),"Bulk Create (JSON)"]})}),e.jsxs(fe,{className:"sm:max-w-[900px] max-h-[90vh] flex flex-col",children:[e.jsxs(ge,{children:[e.jsxs(ve,{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"h-5 w-5"}),'Bulk Create Words for "',y,'"']}),e.jsx(We,{children:"Create multiple vocabulary words at once using JSON format. Each word will be created individually."})]}),e.jsxs(Ls,{value:a,className:"w-full flex-1 flex flex-col overflow-hidden",children:[e.jsxs(_s,{className:"grid w-full grid-cols-4",children:[e.jsx(le,{value:"input",disabled:a==="creating",className:re(a==="input"&&"bg-primary text-primary-foreground",["preview","creating","results"].includes(a)&&"bg-muted"),children:"1. JSON Input"}),e.jsx(le,{value:"preview",disabled:a==="creating"||n.length===0,className:re(a==="preview"&&"bg-primary text-primary-foreground",["creating","results"].includes(a)&&"bg-muted"),children:"2. Preview"}),e.jsx(le,{value:"creating",disabled:!0,className:re(a==="creating"&&"bg-primary text-primary-foreground",a==="results"&&"bg-muted"),children:"3. Creating..."}),e.jsx(le,{value:"results",disabled:i.length===0,className:re(a==="results"&&"bg-primary text-primary-foreground"),children:"4. Results"})]}),e.jsx(te,{value:"input",className:"space-y-4 flex-1 overflow-y-auto",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Words JSON Array"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{variant:"ghost",size:"sm",onClick:we,children:[e.jsx(ds,{className:"h-3 w-3 mr-1"}),"Copy Example"]}),e.jsxs(m,{variant:"ghost",size:"sm",onClick:ye,children:[e.jsx(Fe,{className:"h-3 w-3 mr-1"}),"Download Example"]})]})]}),e.jsx(Z,{value:c,onChange:l=>g(l.target.value),placeholder:"Paste your JSON array here...",className:"min-h-[300px] max-h-[400px] font-mono text-sm resize-none"})]}),T.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-600",children:[e.jsx(be,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Validation Errors:"})]}),e.jsx(ne,{className:"max-h-[100px]",children:e.jsx("ul",{className:"space-y-1 text-sm text-red-600",children:T.map((l,r)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-red-400 mt-0.5",children:"•"}),l]},r))})})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"JSON Format Requirements:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("li",{children:"• Must be a valid JSON array"}),e.jsx("li",{children:'• Each object requires: "word", "translation", "definition", "difficulty", "order"'}),e.jsx("li",{children:'• Optional: "sentence" for example usage'}),e.jsx("li",{children:"• Word & Translation: max 100 characters each"}),e.jsx("li",{children:"• Definition: max 1000 characters"}),e.jsx("li",{children:"• Sentence: max 500 characters (optional)"}),e.jsx("li",{children:'• Difficulty: "easy", "medium", or "hard"'}),e.jsx("li",{children:"• Order: positive number, unique per word"}),e.jsx("li",{children:"• Maximum 100 words per bulk operation"})]})]})]})}),e.jsx(te,{value:"preview",className:"space-y-4 flex-1 overflow-y-auto",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5 text-green-600"}),e.jsxs("span",{className:"font-medium",children:["Ready to create ",n.length," word",n.length>1?"s":""]})]}),e.jsx(ne,{className:"flex-1 max-h-[400px]",children:e.jsx("div",{className:"space-y-3",children:n.map((l,r)=>{const o=se(l.difficulty);return e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(W,{variant:"outline",children:["#",l.order]}),e.jsx("span",{className:"font-medium",children:l.word}),e.jsx("span",{className:"text-muted-foreground",children:"→"}),e.jsx("span",{className:"font-medium",children:l.translation}),e.jsx(W,{variant:"secondary",className:`text-xs ${o.color} border-0 ml-auto`,children:o.label})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:l.definition}),l.sentence&&e.jsxs("p",{className:"text-xs text-muted-foreground italic mt-1 line-clamp-1",children:["Example: ",l.sentence]})]},r)})})})]})}),e.jsx(te,{value:"creating",className:"space-y-4 flex-1 overflow-y-auto",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Creating words..."}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[Math.round(A),"% complete (",i.length," of ",n.length,")"]})]}),e.jsx(Es,{value:A,className:"w-full"}),i.length>0&&e.jsx(ne,{className:"max-h-[300px]",children:e.jsx("div",{className:"space-y-2 text-left",children:i.map((l,r)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.success?e.jsx(Ce,{className:"h-4 w-4 text-green-600"}):e.jsx(be,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:l.success?"text-green-600":"text-red-600",children:l.word.word})]},r))})})]})}),e.jsx(te,{value:"results",className:"space-y-4 flex-1 overflow-y-auto",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.filter(l=>l.success).length}),e.jsx("div",{className:"text-sm text-green-600",children:"Successful"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 dark:bg-red-950 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.filter(l=>!l.success).length}),e.jsx("div",{className:"text-sm text-red-600",children:"Failed"})]})]}),e.jsx(ne,{className:"flex-1 max-h-[400px]",children:e.jsx("div",{className:"space-y-2",children:i.map((l,r)=>e.jsxs("div",{className:"flex items-start gap-3 p-2 rounded border",children:[l.success?e.jsx(Ce,{className:"h-4 w-4 text-green-600 mt-0.5"}):e.jsx(be,{className:"h-4 w-4 text-red-600 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-medium text-sm",children:[l.word.word," → ",l.word.translation]}),l.error&&e.jsx("div",{className:"text-xs text-red-600 mt-1",children:l.error}),l.success&&l.id&&e.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["Created with ID: ",l.id]})]})]},r))})})]})})]}),e.jsxs(Oe,{children:[a==="input"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsx(m,{onClick:Ne,disabled:!c.trim(),children:"Validate & Preview"})]}),a==="preview"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{variant:"outline",onClick:()=>v("input"),children:"Back"}),e.jsxs(m,{onClick:z,disabled:n.length===0,children:["Create ",n.length," Word",n.length>1?"s":""]})]}),a==="creating"&&e.jsxs(m,{disabled:!0,children:["Creating... ",Math.round(A),"%"]}),a==="results"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{variant:"outline",onClick:ee,children:"Create More"}),e.jsx(m,{onClick:()=>x(!1),children:"Done"})]})]})]})]})}function Us({word:d,open:y,onOpenChange:b}){if(!d||!d.image_url)return null;const f=Ds(d.image_url),h=()=>{if(f){const c=document.createElement("a");c.href=f,c.download=`${d.word}_image.jpg`,document.body.appendChild(c),c.click(),document.body.removeChild(c)}},x=()=>{f&&window.open(f,"_blank")};return e.jsx(pe,{open:y,onOpenChange:b,children:e.jsxs(fe,{className:"sm:max-w-[800px]",children:[e.jsx(ge,{children:e.jsxs(ve,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:['Image for "',d.word,'"']}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:h,children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"Download"]}),e.jsxs(m,{variant:"outline",size:"sm",onClick:x,children:[e.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Open in New Tab"]})]})]})}),e.jsx("div",{className:"w-full",children:f?e.jsx("img",{src:f,alt:`Image for ${d.word}`,className:"w-full h-auto max-h-[600px] object-contain rounded-lg border",onError:c=>{c.currentTarget.src="/placeholder-image.png"}}):e.jsx("div",{className:"flex items-center justify-center h-48 bg-muted rounded-lg",children:e.jsx("p",{className:"text-muted-foreground",children:"Image not available"})})}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-3 text-sm",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Word:"})," ",d.word]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Translation:"})," ",d.translation]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-medium",children:"Example:"})," ",d.example_sentence]})]})})]})})}function Js({data:d,isLoading:y,onEdit:b,onRefresh:f,lessonName:h,onPreviewImage:x}){const[c,g]=u.useState(!1),[T,C]=u.useState(null),n=je(),t=Te({mutationFn:a=>P.words.delete(a),onSuccess:a=>{w.success(a.message),n.invalidateQueries({queryKey:["words"]}),n.invalidateQueries({queryKey:["lessons"]}),f(),g(!1),C(null)},onError:a=>{w.error("Failed to delete word"),console.error("Delete error:",a)}}),i=a=>{C(a),g(!0)},q=()=>{T&&t.mutate(T.id)};return y?e.jsxs(B,{children:[e.jsxs(ie,{children:[e.jsx(de,{children:"Words"}),e.jsx(ce,{children:"Loading..."})]}),e.jsx(V,{children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):d.length===0?e.jsxs(B,{children:[e.jsxs(ie,{children:[e.jsx(de,{children:"Words"}),e.jsx(ce,{children:h?`No words found in "${h}"`:"No words found"})]}),e.jsx(V,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(_e,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsxs("p",{className:"text-muted-foreground text-center",children:[h?`No vocabulary words have been created for "${h}" yet.`:"No vocabulary words have been created yet.",e.jsx("br",{}),'Click "Add Word" to get started.']})]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(B,{className:"border-0 shadow-lg bg-gradient-to-br from-card via-card to-card/95",children:[e.jsx(ie,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(de,{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5 text-primary"}),"Words (",d.length,")",h&&e.jsx(W,{variant:"outline",className:"ml-2",children:h})]}),e.jsx(ce,{className:"mt-1",children:h?`Manage vocabulary for "${h}" lesson`:"Manage vocabulary words and their content"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Words"}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:d.length})]})]})}),e.jsx(V,{children:e.jsxs(rs,{children:[e.jsx(ns,{children:e.jsxs(Pe,{children:[e.jsx(G,{children:"Word"}),e.jsx(G,{children:"Translation"}),e.jsx(G,{children:"Example"}),e.jsx(G,{children:"Media"}),e.jsx(G,{className:"w-[70px]",children:"Actions"})]})}),e.jsx(ls,{children:d.map(a=>e.jsxs(Pe,{children:[e.jsx(X,{className:"max-w-[200px]",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium truncate",title:a.word,children:a.word}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["ID: #",a.id]})]})}),e.jsx(X,{className:"max-w-[200px]",children:e.jsx("div",{className:"font-medium text-green-600 truncate",title:a.translation,children:a.translation})}),e.jsx(X,{className:"max-w-[300px]",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground truncate",title:a.example_sentence,children:a.example_sentence}),a.example_audio&&e.jsxs(m,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:()=>{const v=Ie(a.example_audio);v&&new Audio(v).play().catch(O=>{console.error("Error playing audio:",O),w.error("Failed to play audio")})},children:[e.jsx(Ee,{className:"h-3 w-3 mr-1"}),"Play Example"]})]})}),e.jsx(X,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.audio_url&&e.jsx(m,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>{const v=Ie(a.audio_url);v&&new Audio(v).play().catch(O=>{console.error("Error playing audio:",O),w.error("Failed to play audio")})},title:"Play audio",children:e.jsx(Ee,{className:"h-4 w-4 text-blue-600"})}),a.image_url&&e.jsx(m,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>{x?x(a):window.open(Ie(a.image_url),"_blank")},title:"View image",children:e.jsx(es,{className:"h-4 w-4 text-green-600"})}),!a.audio_url&&!a.image_url&&e.jsx(W,{variant:"outline",className:"text-xs",children:"No media"})]})}),e.jsx(X,{children:e.jsxs(gs,{children:[e.jsx(vs,{asChild:!0,children:e.jsxs(m,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(ks,{className:"h-4 w-4"})]})}),e.jsxs(Ns,{align:"end",children:[e.jsx(ws,{children:"Actions"}),e.jsxs(Me,{onClick:()=>b(a),children:[e.jsx(Ze,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(Me,{onClick:()=>i(a),className:"text-red-600",children:[e.jsx(Is,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},a.id))})]})})]}),e.jsx(ys,{open:c,onOpenChange:g,title:"Delete Word",desc:`Are you sure you want to delete "${T?.word}"? This action cannot be undone.`,confirmText:"Delete",handleConfirm:q,isLoading:t.isPending})]})}function Bs(){const d=ss(),y=as({from:"/_authenticated/content/words"}),[b,f]=u.useState(null),[h,x]=u.useState(!1),[c,g]=u.useState(!1),[T,C]=u.useState(null),[n,t]=u.useState(""),[i,q]=u.useState(y.lessonId?.toString()||""),[a,v]=u.useState("all"),[A,O]=u.useState(!1),{data:U=[]}=R({queryKey:["courses"],queryFn:()=>P.courses.list()}),{data:F=[],isLoading:Ne}=R({queryKey:["lessons"],queryFn:()=>P.lessons.list()}),{data:z=[]}=R({queryKey:["learning-centers"],queryFn:()=>Ss.list()}),{data:ee=[],isLoading:we,refetch:ye}=R({queryKey:["words",i],queryFn:()=>P.words.list({lesson_id:i?parseInt(i):void 0}),enabled:!!i});u.useEffect(()=>{y.lessonId&&F.length>0&&q(y.lessonId.toString())},[y.lessonId,F]);const se=ee.filter(s=>{const j=s.word.toLowerCase().includes(n.toLowerCase())||s.translation.toLowerCase().includes(n.toLowerCase())||s.definition.toLowerCase().includes(n.toLowerCase()),D=a==="all"||s.difficulty===a;return j&&D}),l=s=>{f(s),x(!0)},r=s=>{C(s),g(!0)},o=()=>{ye()},S=s=>{q(s),t(""),v("all"),d({to:"/content/words",search:s?{lessonId:parseInt(s)}:{}})},p=F.find(s=>s.id.toString()===i),$=p?U.find(s=>s.id===p.course_id):null,J=z.find(s=>s.id===$?.learning_center_id);return i?e.jsxs(e.Fragment,{children:[e.jsxs(Ue,{children:[e.jsx(qe,{links:Qe}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(Ve,{}),e.jsx(Je,{}),e.jsx(He,{}),e.jsx(Be,{})]})]}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"Words Management"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("p",{className:"text-muted-foreground text-lg",children:"Managing words for"}),J&&e.jsxs(Se,{className:"h-5 w-5",children:[e.jsx(De,{src:Le(J.logo||""),alt:J.name}),e.jsx(ke,{children:e.jsx(Os,{className:"h-3 w-3"})})]}),e.jsx(W,{variant:"outline",children:p?.title}),e.jsx("span",{className:"text-muted-foreground",children:"in"}),e.jsx(W,{variant:"secondary",children:$?.title})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(m,{variant:"outline",onClick:()=>q(""),children:"Change Lesson"}),e.jsx(Ms,{lessonId:parseInt(i),lessonName:p?.title||"Selected Lesson",onSuccess:o}),e.jsx(qs,{lessonId:parseInt(i),onSuccess:o,children:e.jsxs(m,{size:"lg",className:"bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary/80 shadow-lg hover:shadow-xl transition-all duration-200",children:[e.jsx(Fs,{className:"mr-2 h-5 w-5"}),"Add Word"]})})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(H,{placeholder:"Search words, translations, or definitions...",value:n,onChange:s=>t(s.target.value),className:"w-full"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(me,{value:a,onValueChange:v,children:[e.jsx(xe,{className:"w-[140px]",children:e.jsx(he,{placeholder:"All Levels"})}),e.jsxs(ue,{children:[e.jsx(Y,{value:"all",children:"All Levels"}),Q.map(s=>e.jsx(Y,{value:s.value,children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(W,{variant:"secondary",className:`text-xs ${s.color} border-0`,children:s.label})})},s.value))]})]}),e.jsxs(m,{variant:"outline",size:"sm",children:[e.jsx(Fe,{className:"h-4 w-4"}),"Export"]})]})]}),(n||a!=="all")&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-6",children:[e.jsxs("span",{children:["Showing ",se.length," of ",ee.length," words"]}),n&&e.jsxs(W,{variant:"secondary",children:['Search: "',n,'"']}),a!=="all"&&e.jsxs(W,{variant:"secondary",children:["Level: ",Q.find(s=>s.value===a)?.label]}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>{t(""),v("all")},children:"Clear filters"})]}),e.jsx(Js,{data:se,isLoading:we,onEdit:l,onPreviewImage:r,onRefresh:o,lessonName:p?.title})]}),e.jsx(As,{word:b,open:h,onOpenChange:x,onSuccess:o}),e.jsx(Us,{word:T,open:c,onOpenChange:g})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Ue,{children:[e.jsx(qe,{links:Qe}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(Ve,{}),e.jsx(Je,{}),e.jsx(He,{}),e.jsx(Be,{})]})]}),e.jsxs(Ae,{children:[e.jsx("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"Words Management"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Select a lesson to manage its vocabulary words"})]})}),e.jsxs(B,{className:"max-w-2xl mb-6",children:[e.jsxs(ie,{children:[e.jsxs(de,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-5 w-5"}),"Select Lesson"]}),e.jsx(ce,{children:"Choose a lesson to manage its vocabulary words and content"})]}),e.jsxs(V,{className:"space-y-4",children:[e.jsxs(cs,{open:A,onOpenChange:O,children:[e.jsx(os,{asChild:!0,children:e.jsxs(m,{variant:"outline",role:"combobox","aria-expanded":A,className:"w-full justify-between",children:[i?(()=>{const s=F.find(N=>N.id.toString()===i),j=U.find(N=>N.id===s?.course_id),D=z.find(N=>N.id===j?.learning_center_id);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Se,{className:"h-6 w-6",children:[e.jsx(De,{src:Le(D?.logo||""),alt:D?.name}),e.jsx(ke,{children:e.jsx(oe,{className:"h-3 w-3"})})]}),e.jsx("span",{className:"truncate",children:s?.title})]})})():e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ws,{className:"h-4 w-4"}),e.jsx("span",{children:"Search lessons..."})]}),e.jsx(ms,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(xs,{className:"w-full p-0",children:e.jsxs(hs,{children:[e.jsx(us,{placeholder:"Search lessons..."}),e.jsx(js,{children:"No lessons found."}),e.jsx(ps,{children:F.map(s=>{const j=U.find(N=>N.id===s.course_id),D=z.find(N=>N.id===j?.learning_center_id);return e.jsx(fs,{value:`${s.title} ${j?.title||""}`,onSelect:()=>{S(s.id.toString()),O(!1)},children:e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsxs(Se,{className:"h-8 w-8",children:[e.jsx(De,{src:Le(D?.logo||""),alt:D?.name}),e.jsx(ke,{children:e.jsx(oe,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:s.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[j?.title||`Course ${s.course_id}`," • Words"]})]}),e.jsx(bs,{className:`ml-auto h-4 w-4 ${i===s.id.toString()?"opacity-100":"opacity-0"}`})]})},s.id)})})]})})]}),Ne&&e.jsxs("div",{className:"flex items-center justify-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Loading lessons..."})]})]})]}),F.length>0&&e.jsxs("div",{className:"grid gap-4 md:grid-cols-3 max-w-2xl",children:[e.jsx(B,{children:e.jsxs(V,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold",children:F.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Lessons"})]})}),e.jsx(B,{children:e.jsxs(V,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold",children:F.reduce((s,j)=>s+(j.words_count||0),0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Words"})]})}),e.jsx(B,{children:e.jsxs(V,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold",children:U.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Courses"})]})})]})]})]})}const Qe=[{title:"Courses",href:"/content/courses",isActive:!1,disabled:!1},{title:"Lessons",href:"/content/lessons",isActive:!1,disabled:!1},{title:"Words",href:"/content/words",isActive:!0,disabled:!1}],xa=Bs;export{xa as component};
