import{r as N,f as P,j as e,B as c,o as K,t as d,s as g}from"./index-0K8_KBWg.js";import{u as Q,a as W,I as H}from"./label-B6XJpnN_.js";import{u as L,F as X,a as x,b as h,c as j,d as p,e as v,S as ee}from"./form-B7q3Af8_.js";import{O as E,Q as se,R as _,T as k,U as q,M as ae,V as A,W as D,A as M,s as T,t as B,_ as re}from"./sign-out-dialog-Bj9Nd96b.js";import{S as w,a as S,b as y,c as U,d as F}from"./select-CfYotgYZ.js";import{C as ne,c as G}from"./content-api-D7FNUFJL.js";import{g as le}from"./media-utils-Cpm_6zhn.js";import{U as V}from"./upload-DBzB60bY.js";import{I as z}from"./image-sK2fAx-r.js";import{L as ie}from"./loader-circle-CKwycFYN.js";const te=K({title:g().min(1,"Course title is required"),native_language:g().min(1,"Native language is required"),learning_language:g().min(1,"Learning language is required")}),O=["English","Spanish","French","German","Italian","Portuguese","Russian","Chinese","Japanese","Korean","Arabic","Hindi","Uzbek","Turkish","Persian","Urdu"];function fe({children:n,onSuccess:f}){const[i,u]=N.useState(!1),t=P(),a=Q({resolver:W(te),defaultValues:{title:"",native_language:"",learning_language:""}}),l=L({mutationFn:s=>G.courses.create(s),onSuccess:()=>{d.success("Course created successfully"),t.invalidateQueries({queryKey:["courses"]}),a.reset(),u(!1),f?.()},onError:s=>{d.error("Failed to create course"),console.error("Create course error:",s)}}),m=s=>{l.mutate(s)};return e.jsxs(E,{open:i,onOpenChange:u,children:[e.jsx(se,{asChild:!0,children:n||e.jsxs(c,{children:[e.jsx(ne,{className:"h-4 w-4"}),"Add Course"]})}),e.jsxs(_,{className:"sm:max-w-[600px]",children:[e.jsxs(k,{children:[e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5"}),"Create New Course"]}),e.jsx(A,{children:"Create a new language learning course with native and target languages."})]}),e.jsx(X,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(m),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsx(x,{control:a.control,name:"title",render:({field:s})=>e.jsxs(h,{children:[e.jsx(j,{children:"Course Title *"}),e.jsx(p,{children:e.jsx(H,{placeholder:"e.g., English for Beginners",...s})}),e.jsx(v,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(x,{control:a.control,name:"native_language",render:({field:s})=>e.jsxs(h,{children:[e.jsx(j,{children:"Native Language *"}),e.jsxs(w,{onValueChange:s.onChange,value:s.value,children:[e.jsx(p,{children:e.jsx(S,{children:e.jsx(y,{placeholder:"Select native language"})})}),e.jsx(U,{children:O.map(r=>e.jsx(F,{value:r,children:r},r))})]}),e.jsx(v,{})]})}),e.jsx(x,{control:a.control,name:"learning_language",render:({field:s})=>e.jsxs(h,{children:[e.jsx(j,{children:"Target Language *"}),e.jsxs(w,{onValueChange:s.onChange,value:s.value,children:[e.jsx(p,{children:e.jsx(S,{children:e.jsx(y,{placeholder:"Select target language"})})}),e.jsx(U,{children:O.map(r=>e.jsx(F,{value:r,children:r},r))})]}),e.jsx(v,{})]})})]})]}),e.jsxs(D,{children:[e.jsx(c,{type:"button",variant:"outline",onClick:()=>u(!1),children:"Cancel"}),e.jsx(c,{type:"submit",disabled:l.isPending,className:"min-w-[100px]",children:l.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creating..."]}):"Create Course"})]})]})})]})]})}const oe=K({title:g().min(1,"Course title is required"),native_language:g().min(1,"Native language is required"),learning_language:g().min(1,"Learning language is required")}),J=["English","Spanish","French","German","Italian","Portuguese","Russian","Chinese","Japanese","Korean","Arabic","Hindi","Uzbek","Turkish","Persian","Urdu"];function Ce({course:n,open:f,onOpenChange:i,onSuccess:u}){const t=P(),a=Q({resolver:W(oe),defaultValues:{title:"",native_language:"",learning_language:""}}),l=L({mutationFn:s=>{if(!n)throw new Error("No course selected");return G.courses.update(n.id,s)},onSuccess:()=>{d.success("Course updated successfully"),t.invalidateQueries({queryKey:["courses"]}),i(!1),u?.()},onError:s=>{d.error("Failed to update course"),console.error("Update course error:",s)}});N.useEffect(()=>{n&&a.reset({title:n.title,native_language:n.native_language,learning_language:n.learning_language})},[n,a]);const m=s=>{l.mutate(s)};return n?e.jsx(E,{open:f,onOpenChange:i,children:e.jsxs(_,{className:"sm:max-w-[600px]",children:[e.jsxs(k,{children:[e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"Edit Course"]}),e.jsx(A,{children:"Update the course information and settings."})]}),e.jsx(X,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(m),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsx(x,{control:a.control,name:"title",render:({field:s})=>e.jsxs(h,{children:[e.jsx(j,{children:"Course Title *"}),e.jsx(p,{children:e.jsx(H,{placeholder:"e.g., English for Beginners",...s})}),e.jsx(v,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(x,{control:a.control,name:"native_language",render:({field:s})=>e.jsxs(h,{children:[e.jsx(j,{children:"Native Language *"}),e.jsxs(w,{onValueChange:s.onChange,value:s.value,children:[e.jsx(p,{children:e.jsx(S,{children:e.jsx(y,{placeholder:"Select native language"})})}),e.jsx(U,{children:J.map(r=>e.jsx(F,{value:r,children:r},r))})]}),e.jsx(v,{})]})}),e.jsx(x,{control:a.control,name:"learning_language",render:({field:s})=>e.jsxs(h,{children:[e.jsx(j,{children:"Target Language *"}),e.jsxs(w,{onValueChange:s.onChange,value:s.value,children:[e.jsx(p,{children:e.jsx(S,{children:e.jsx(y,{placeholder:"Select target language"})})}),e.jsx(U,{children:J.map(r=>e.jsx(F,{value:r,children:r},r))})]}),e.jsx(v,{})]})})]})]}),e.jsxs(D,{children:[e.jsx(c,{type:"button",variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsx(c,{type:"submit",disabled:l.isPending,className:"min-w-[100px]",children:l.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Updating..."]}):"Update Course"})]})]})})]})}):null}function Ne({open:n,onOpenChange:f,course:i,onSuccess:u}){const[t,a]=N.useState(null),[l,m]=N.useState(null),s=N.useRef(null),r=P(),b=L({mutationFn:o=>G.courses.uploadLogo(i.id,o),onSuccess:o=>{d.success(o.message),a(null),m(null),r.invalidateQueries({queryKey:["courses"]}),u()},onError:o=>{d.error("Failed to upload course logo"),console.error("Upload course logo error:",o)}}),$=o=>{const C=o.target.files?.[0];if(!C)return;if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(C.type)){d.error("Only JPEG, PNG, and WebP images are allowed");return}if(C.size>5*1024*1024){d.error("File size must be less than 5MB");return}a(C);const Z=URL.createObjectURL(C);m(Z)},Y=()=>{t&&b.mutate(t)},R=()=>{a(null),l&&(URL.revokeObjectURL(l),m(null)),s.current&&(s.current.value="")},I=o=>{o||R(),f(o)};return e.jsx(E,{open:n,onOpenChange:I,children:e.jsxs(_,{className:"max-w-md",children:[e.jsxs(k,{children:[e.jsxs(q,{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"h-5 w-5"}),e.jsx("span",{children:"Upload Course Logo"})]}),e.jsxs(A,{children:['Upload a new logo for "',i.title,'". Supported formats: JPEG, PNG, WebP (max 5MB).']})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-sm font-medium",children:"Current Logo:"}),e.jsxs(M,{className:"h-12 w-12",children:[e.jsx(T,{src:le(i.logo_url),alt:i.title}),e.jsx(B,{children:e.jsx(z,{className:"h-6 w-6"})})]})]}),e.jsx("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-6",children:t?e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(M,{className:"h-20 w-20",children:[e.jsx(T,{src:l||void 0,alt:"Preview"}),e.jsx(B,{children:e.jsx(z,{className:"h-8 w-8"})})]}),e.jsx(c,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 rounded-full p-0",onClick:R,children:e.jsx(re,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium",children:t.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[(t.size/1024/1024).toFixed(2)," MB"]})]})]}):e.jsxs("div",{className:"text-center",children:[e.jsx(V,{className:"mx-auto h-12 w-12 text-muted-foreground"}),e.jsx("div",{className:"mt-4",children:e.jsx(c,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:"Choose File"})}),e.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"JPEG, PNG, WebP up to 5MB"})]})}),e.jsx("input",{ref:s,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:$,className:"hidden"})]}),e.jsxs(D,{children:[e.jsx(c,{type:"button",variant:"outline",onClick:()=>I(!1),disabled:b.isPending,children:"Cancel"}),e.jsxs(c,{type:"button",onClick:Y,disabled:!t||b.isPending,children:[b.isPending&&e.jsx(ie,{className:"mr-2 h-4 w-4 animate-spin"}),"Upload Logo"]})]})]})})}export{fe as C,Ce as E,Ne as U};
